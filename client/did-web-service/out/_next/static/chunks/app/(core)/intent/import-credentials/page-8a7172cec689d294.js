(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9590],{9762:function(e,t,n){Promise.resolve().then(n.bind(n,57142))},48750:function(e,t,n){"use strict";n.d(t,{O:function(){return s}});var i=n(57437),r=n(40471),l=n(57042);let s=e=>{let{className:t}=e;return(0,i.jsxs)("div",{className:(0,l.Z)("flex flex-col w-full",t),children:[(0,i.jsx)("div",{className:"italic",children:"Preparing request, hold on..."}),(0,i.jsx)(r.Z,{})]})}},57142:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return F}});var i=n(57437),r=n(85688),l=n(2265),s=n(48750),a=n(12131),o=n(26588),c=n(451),d=n(69144),u=n(13457),f=n(43226),h=n(3283),x=n(96556),m=n(53932),j=n(3883),g=n(53445),p=n(48727),v=n(81344),S=n(35551),Z=n(15133),y=n(14819),w=n(29872),b=n(35843),I=n(9177),k=n(16691),C=n.n(k);let P=(0,b.ZP)(w.Z)(e=>{let{theme:t}=e;return{backgroundColor:"#eeeeee",textAlign:"left",maxWidth:400}}),W=e=>{let{credential:t}=e,n=t.getValueItems(),r=t.isSensitiveCredential(),[l]=(0,c.V)(null==t?void 0:t.issuerInfo$);return(0,i.jsx)(u.Z,{alignItems:"center",children:(0,i.jsx)(Z.Z,{sx:{mx:10,mt:4,mb:1,boxShadow:0,textAlign:"left",bgcolor:"#ffffff"},children:(0,i.jsxs)(u.Z,{spacing:2,direction:"row",px:2,py:2,minWidth:400,maxWidth:400,children:[(0,i.jsx)(y.Z,{sx:{fontSize:40}}),(0,i.jsxs)(u.Z,{alignItems:"left",children:[(0,i.jsx)(f.Z,{fontSize:18,gutterBottom:!0,children:(0,i.jsx)("b",{children:t.getDisplayableTitle()})}),null==n?void 0:n.map(e=>(0,i.jsx)(f.Z,{fontSize:16,gutterBottom:!0,children:null==e?void 0:e.value},e.name+"credentialcomponentitem")),r&&(0,i.jsx)(f.Z,{fontSize:14,color:"#FF6347",gutterBottom:!0,children:"Sensitive"}),(0,i.jsx)(P,{sx:{my:1,mx:"auto",p:2},children:(0,i.jsxs)(u.Z,{spacing:2,direction:"row",alignItems:"center",children:[(0,i.jsx)(u.Z,{children:(0,i.jsx)(C(),{unoptimized:!0,src:null==l?void 0:l.avatarIcon,width:30,height:30,style:{borderRadius:"50%"},alt:""})}),(0,i.jsx)(u.Z,{sx:{maxWidth:400},children:(0,i.jsx)(f.Z,{fontSize:13,noWrap:!0,children:l&&(0,I.Sy)(null==l?void 0:l.name,30)})})]})})]})]})})})},N=e=>{let{importedCredential:t}=e,[n,r]=(0,l.useState)(!1),[s,a]=(0,l.useState)(!1),[o,c]=(0,l.useState)(!1),d=()=>{a(!1)},h=()=>{a(!0)};return(0,i.jsxs)(u.Z,{alignItems:"center",children:[(0,i.jsx)(W,{credential:t.credential}),n&&(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(S.Z,{variant:"text",onClick:()=>{r(!1)},children:"hide details"}),t.values.map(e=>(0,i.jsxs)(Z.Z,{sx:{mx:10,my:1,boxShadow:0,textAlign:"left",bgcolor:"#ffffff"},children:[!s&&(0,i.jsx)(u.Z,{px:2,py:2,minWidth:400,alignItems:"left",children:(0,i.jsx)("div",{onClick:h,children:(0,i.jsxs)(u.Z,{direction:"row",alignItems:"right",children:[(0,i.jsx)(f.Z,{fontSize:16,minWidth:350,gutterBottom:!0,children:(0,i.jsx)("b",{children:e.name})}),(0,i.jsx)(v.Z,{})]})})}),s&&(0,i.jsxs)(u.Z,{px:2,py:2,minWidth:400,alignItems:"left",children:[(0,i.jsx)("div",{onClick:d,children:(0,i.jsxs)(u.Z,{direction:"row",alignItems:"right",children:[(0,i.jsx)(f.Z,{fontSize:16,minWidth:350,gutterBottom:!0,children:(0,i.jsx)("b",{children:e.name})}),(0,i.jsx)(p.Z,{})]})}),(0,i.jsx)(f.Z,{fontSize:14,gutterBottom:!0,children:e.value})]})]},t.name+"-credentialcomponennt"))]}),!n&&(0,i.jsx)(u.Z,{direction:"row",children:(0,i.jsx)(S.Z,{variant:"text",onClick:()=>{r(!0)},children:"Show details"})})]})},q=e=>{let{intent:t}=e,[n]=(0,c.V)(m.B);null==n||n.get("profile");let s=null==n?void 0:n.get("credentials"),[p,v]=(0,l.useState)(!1),[S,Z]=(0,l.useState)(null),[y,w]=(0,l.useState)(!1),[b,I]=(0,l.useState)(""),[k,C]=(0,l.useState)(""),{showErrorToast:P}=(0,x.p)(),W=t.requestPayload;(0,l.useEffect)(()=>{q(),z(),F(),W&&_(W.credentials).then(e=>{Z(e)})},[W]);let q=()=>{w(!1)},z=()=>{I("")},F=()=>{C("Demo app")},_=async e=>{if(!e)return[];let t=[];for(let n of e){let e=o.VerifiableCredential.parse(n.toString()),i=e.getSubject().getProperties(),r=[];for(let e of Object.keys(i)){let t=i[e];if("id"==e||"displayable"==e)continue;let n={name:e,value:t.toString()};r.push(n)}let l={name:e.getId().getFragment(),values:r,credential:await (0,d.C)(e)};t.push(l)}return t},B=async()=>{v(!0);let e=[];S.map(t=>{e.push(t.credential.getId().toString())});let n=!1;try{for(let e of S)await s.importCredential(e.credential.verifiableCredential);n=await (0,r.h)(t.id,e)}catch(e){j.k.error("ImportCredential","Import credential error",e)}if(!n){P("Import credential error, Please retry after a while.");return}let i=(0,g.Q)(t.redirectUrl,"rid",t.id);window.location.href=i};return(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsxs)("div",{className:" text-center",children:[(0,i.jsxs)(u.Z,{direction:"row",justifyContent:"center",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(h.Z,{sx:{ml:2,width:120,height:120}})]}),(0,i.jsx)(f.Z,{mt:4,children:k}),(0,i.jsx)(f.Z,{mt:4,children:"You are going to attach some infomation provided by a third party to your identity."}),(0,i.jsx)(f.Z,{mt:1,children:"Please review the following data:"}),null==S?void 0:S.map((e,t)=>(0,i.jsx)(N,{importedCredential:e},t)),(0,i.jsx)(a.c,{onClick:B,busy:p,children:"Import this to my profile"})]}),!n&&"Make an identity active to continue"]})};var z=n(24033),F=()=>{let e=(0,z.useSearchParams)(),t=e.get("rid"),[n,a]=(0,l.useState)(!0),[o,c]=(0,l.useState)(null);return(0,l.useEffect)(()=>{t&&(0,r.S)(t).then(e=>{a(!1),c(e)})},[]),(0,i.jsxs)("div",{className:"col-span-full",children:[n&&(0,i.jsx)(s.O,{className:"mb-6"}),!n&&o&&(0,i.jsx)(q,{intent:o}),!n&&!o&&(0,i.jsx)("div",{children:"No matching request"})]})}},96556:function(e,t,n){"use strict";n.d(t,{p:function(){return r}});var i=n(36953);function r(){let{enqueueSnackbar:e}=(0,i.Ds)();return{showSuccessToast:t=>{e(t,{variant:"success"})},showErrorToast:t=>{e(t,{variant:"error"})}}}},85688:function(e,t,n){"use strict";n.d(t,{S:function(){return u},h:function(){return f}});var i=n(60230),r=n(23965);class l{static async fromJson(e){let t=new l;return Object.assign(t,e),t.createdAt=new Date(e.createdAt),t}}var s=n(51385),a=n(76506),o=n(3883);function c(){let e=(0,i._)(["\n      query GetIntentRequest($intentId: String!) {\n        intent (id: $intentId) {\n          ","\n        }\n      }\n    "]);return c=function(){return e},e}function d(){let e=(0,i._)(["\n      mutation FulfilIntentRequest($input: FulfilIntentInput!) {\n        fulfilIntent (input: $input)\n      }\n    "]);return d=function(){return e},e}async function u(e){let{data:t}=await (0,s.Pt)(async()=>(await (0,a.W)()).query({query:(0,r.Ps)(c(),"\n  id\n  createdAt\n  type\n  redirectUrl\n  requestPayload\n  responsePayload\n"),variables:{intentId:e}}));if(t&&t.intent){let e=await l.fromJson(t.intent);return o.k.log("intents","Fetched intent:",e),e}return o.k.warn("intents","No intent found for id ".concat(e)),null}async function f(e,t){let{data:n}=await (0,s.Pt)(async()=>(await (0,a.W)()).mutate({mutation:(0,r.Ps)(d()),variables:{input:{intentId:e,payload:t}}}));return n&&n.fulfilIntent?(o.k.log("intents","Successfully fulfilled intent id ".concat(e)),!0):(o.k.warn("intents","Failed to fulfil intent id ".concat(e)),!1)}},53445:function(e,t,n){"use strict";function i(e,t,n){let i=new URL(e),r=new URLSearchParams(i.search);return r.set(t,n),i.search=r.toString(),i.toString()}n.d(t,{Q:function(){return i}})}},function(e){e.O(0,[6990,9787,9443,8218,6110,2361,8920,7679,3412,6953,7695,8118,6432,9855,2971,596,1744],function(){return e(e.s=9762)}),_N_E=e.O()}]);