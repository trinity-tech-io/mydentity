(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1324],{11616:function(e,t,i){Promise.resolve().then(i.bind(i,70449))},70449:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return em}});var n,l,r=i(57437),a=i(7045),s=i(46940),o=i(66988),d=i(98489),c=i(30666),h=i(95781),u=i(96507);let p={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};var x=e=>{let{order:t,orderBy:i,rowCount:n,headLabel:l,numSelected:a,onRequestSort:s,onSelectAllClick:x}=e,g=e=>t=>{s(t,e)};return(0,r.jsx)(o.Z,{children:(0,r.jsx)(d.Z,{children:l.map(e=>(0,r.jsx)(c.Z,{align:e.alignRight?"right":"left",sortDirection:i===e.id&&t,children:(0,r.jsxs)(h.Z,{hideSortIcon:!0,active:i===e.id,direction:i===e.id?t:"asc",onClick:g(e.id),children:[e.label,i===e.id?(0,r.jsx)(u.Z,{sx:{...p},children:"desc"===t?"sorted descending":"sorted ascending"}):null]})},e.id))})})},g=i(46446),j=i(58991),m=i(34989),y=i(90923),Z=i(43226),v=i(81679),f=i(78276),b=i(52653),C=i(35843),w=i(89975);let S=(0,C.ZP)(m.Z)(e=>{let{theme:t}=e;return{height:96,display:"flex",justifyContent:"space-between",padding:t.spacing(0,1,0,3)}}),k=(0,C.ZP)(y.Z)(e=>{let{theme:t}=e;return{width:240,transition:t.transitions.create(["box-shadow","width"],{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.shorter}),"&.Mui-focused":{width:320,boxShadow:"0 8px 16px 0 ".concat((0,w.Fq)("#919EAB",.16))},"& fieldset":{borderWidth:"1px !important",borderColor:"".concat((0,w.Fq)(t.palette.grey[500],.32)," !important")}}});var D=e=>{let{numSelected:t,filterName:i,onFilterName:n}=e;return(0,r.jsxs)(S,{sx:{...t>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t>0?(0,r.jsxs)(Z.Z,{component:"div",variant:"subtitle1",children:[t," selected"]}):(0,r.jsx)(k,{value:i,onChange:n,placeholder:"Search user...",startAdornment:(0,r.jsx)(v.Z,{position:"start",children:(0,r.jsx)(j.Z,{})})}),t>0?(0,r.jsx)(f.Z,{title:"Delete",onClick:()=>{},children:(0,r.jsx)(b.Z,{children:(0,r.jsx)(g.Z,{})})}):(0,r.jsx)(r.Fragment,{})]})},P=i(49599),I=i(54986),E=i(3283),N=i(22079),V=i(91797),A=i(35266),F=i(69299),R=i(73393),T=i(72502),W=i(38212),_=i(35511),M=i(9177),O=e=>{let{onClose:t,open:i,availableItemsForAddition:n}=e,l=e=>{t(e)};return(0,r.jsxs)(N.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>{t(null)},open:i,children:[(0,r.jsx)(V.Z,{children:"Add profile information"}),(0,r.jsx)(I.Z,{}),(0,r.jsx)(A.Z,{sx:{pt:0},children:null==n?void 0:n.map((e,t)=>(0,r.jsx)(F.ZP,{disableGutters:!0,children:(0,r.jsxs)(T.Z,{onClick:()=>l(e),children:[(0,r.jsx)(R.Z,{children:(0,r.jsx)(E.Z,{sx:{bgcolor:_.Z[100],color:_.Z[600]},children:(0,r.jsx)(P.Z,{})})}),(0,r.jsx)(W.Z,{primary:(0,M.fm)(e.key)})]})},t))})]})},B=i(12854),q=i(20484),L=i(451),U=i(42937),z=i(89396),$=i(4856),G=i(13457),Y=i(88938),H=i(35551),J=i(15133),K=i(15795),Q=i(73701),X=i(39279),ee=i(19464),et=i(59500),ei=i(74309),en=i(96556),el=i(59606),er=i(53932),ea=i(3883),es=i(77434),eo=i.n(es),ed=i(61396),ec=i.n(ed),eh=i(24033),eu=i(2265),ep=i(22440);let ex=e=>{let{credential:t,width:i=120,height:n=120}=e,[l]=(0,L.V)(null==t?void 0:t.representativeIcon$);return(0,r.jsx)(E.Z,{sx:{width:i,height:n},src:l,children:!l&&(0,r.jsx)(a.Z,{style:{width:"70%"}})})},eg=e=>{let{credential:t,onFileUpload:i}=e,n=async e=>{if((null==e?void 0:e.length)>0){let t=e[0];i(t)}},{getRootProps:l,getInputProps:a,isDragActive:s,isDragReject:o,fileRejections:d}=(0,ep.uI)({multiple:!1,maxFiles:1,onDrop:n});return(0,r.jsxs)("div",{...l(),style:{...s&&{opacity:.72}},className:"cursor-pointer",children:[(0,r.jsx)("input",{...a()}),(0,r.jsx)(ex,{credential:t})]})};(n=l||(l={})).NAME="name",n.VALUE="value";let ej=[{id:"name",label:"Name",alignRight:!1},{id:"value",label:"Value",alignRight:!1},{id:"",alignRight:!1}];var em=()=>{let e="ProfilePage",[t]=(0,L.V)(er.B),i=null==t?void 0:t.get("credentials"),n=null==t?void 0:t.get("profile"),[o]=(0,L.V)(null==n?void 0:n.profileCredentials$),{mounted:h}=(0,U.s)(),p=(0,eh.useRouter)(),[g]=(0,L.V)(null==n?void 0:n.avatarCredential$),[j,m]=(0,eu.useState)(null),[y,v]=(0,eu.useState)([]),[f,C]=(0,eu.useState)(!1),[w,S]=(0,eu.useState)(!1),[k,P]=(0,eu.useState)(null),[I,N]=(0,eu.useState)(""),[V,A]=(0,eu.useState)(B.b1.NEW),{showSuccessToast:F,showErrorToast:R}=(0,en.p)(),[T,W]=(0,eu.useState)(null),[_,M]=(0,eu.useState)(0),[es,ed]=(0,eu.useState)("asc"),[ep,ex]=(0,eu.useState)([]),[em,ey]=(0,eu.useState)(l.NAME),[eZ,ev]=(0,eu.useState)(""),[ef,eb]=(0,eu.useState)(5),[eC,ew]=(0,eu.useState)(!1),eS=(0,el.yd)(),ek=t&&"https://eid.elastos.io/did?did=".concat(encodeURIComponent(t.did),"&is_did=true"),eD=()=>{let e=null==eS?void 0:eS.filter(e=>e.options.multipleInstancesAllowed||!(null==o?void 0:o.find(t=>{var i;return t.verifiableCredential.type.includes(null===(i=e.type)||void 0===i?void 0:i.getShortType())})));v(e)};(0,eu.useEffect)(()=>{eD()},[o]);let eP=(e,t,i)=>{e?F(t):R(i)},eI=async t=>{if(S(!1),t&&t.value){if(t.type==B.b1.EDIT&&t.originCredential){let i=!1;try{i=await n.updateProfileCredential(t.originCredential,t.value).catch()}catch(t){ea.k.error(e,"Update credential error",t)}eP(i,"Entry has been updated!","Failed to update the entry...")}if(t.type==B.b1.NEW&&!j){let i=!1;try{i=!!await n.createProfileCredential("",t.info.typesForCreation(),t.info.key,t.value)}catch(t){ea.k.error(e,"Create credential error",t)}eP(i,"Entry has been created!","Failed to create the entry...")}}},eE=(e,t)=>{e.stopPropagation(),e.preventDefault(),W(e.currentTarget),m(t)},eN=()=>{W(null)};function eV(e,t,i){switch(i){case"name":return e.getDisplayableTitle().localeCompare(t.getDisplayableTitle());case"value":{let i=e.getDisplayValue().label?e.getDisplayValue().label:e.getDisplayValue(),n=t.getDisplayValue().label?t.getDisplayValue().label:t.getDisplayValue();return i.localeCompare(n)}}}let eA=_>0?Math.max(0,(1+_)*ef-(null==o?void 0:o.length)):0,eF=function(e,t,i){let n=null==e?void 0:e.map((e,t)=>[e,t]);return(null==n||n.sort((e,i)=>{let n=t(e[0],i[0]);return 0!==n?n:e[1]-i[1]}),i)?eo()(e,e=>-1!==e.verifiableCredential.getId().getFragment().toLowerCase().indexOf(i.toLowerCase())):null==n?void 0:n.map(e=>e[0])}(o,"desc"===es?(e,t)=>eV(e,t,em):(e,t)=>-eV(e,t,em),eZ),eR=!(null==eF?void 0:eF.length)&&!!eZ,eT=async t=>{if(ew(!1),!t)return;let n=!1;try{n=await i.deleteCredential(j)}catch(t){ea.k.error(e,t)}eP(n,"Entry has been deleted","Failed to delete the entry...")},eW=e=>{let t="Your current credential is: "+e.getDisplayValue();F(t),n.setActiveCredential(e),p.replace("/credentials/list")};return(0,r.jsxs)("div",{className:"col-span-full",children:[(0,r.jsx)(u.Z,{mt:2,component:"form",sx:{"& .MuiTextField-root":{m:1,width:"25ch"}},noValidate:!0,autoComplete:"off",children:(0,r.jsx)(G.Z,{alignItems:"center",spacing:3,sx:{pt:5,borderRadius:2,position:"relative"},children:(0,r.jsx)(eg,{credential:g,onFileUpload:e=>{n.upsertIdentityAvatar(e)}})})}),(0,r.jsxs)(Y.Z,{children:[(0,r.jsxs)(G.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,r.jsx)(Z.Z,{variant:"h4",gutterBottom:!0,children:"About me"}),(0,r.jsx)(H.Z,{variant:"contained",startIcon:(0,r.jsx)(z.Z,{}),onClick:()=>{C(!0)},children:"New profile item"})]}),(0,r.jsxs)(Z.Z,{gutterBottom:!0,children:[(0,r.jsx)("i",{children:"Good to know"}),": every item in the list below is stored in your identity as an individual ",(0,r.jsx)("b",{children:"credential"}),". Credentials can later be shared to apps that request them, with your consent. Credentials are always signed with your own signature so no matter where they are shared, one can always make sure that ",(0,r.jsx)("b",{children:"the information inside was created by you, and not modified"}),"."]}),(!o||!h)&&(0,r.jsx)(q.q,{}),o&&h&&(0,r.jsxs)(J.Z,{children:[(0,r.jsx)(D,{numSelected:ep.length,filterName:eZ,onFilterName:e=>{M(0),ev(e.target.value)}}),(0,r.jsx)(K.Z,{sx:{maxWidth:1200},children:(0,r.jsxs)(Q.Z,{children:[(0,r.jsx)(x,{order:es,orderBy:em,headLabel:ej,rowCount:o?o.length:0,numSelected:ep?ep.length:0,onRequestSort:(e,t)=>{let i=em===t&&"asc"===es;ed(i?"desc":"asc"),ey(t)},onSelectAllClick:()=>{}}),(0,r.jsxs)(X.Z,{children:[null==eF?void 0:eF.slice(_*ef,_*ef+ef).map(e=>{let t=e.id;return(0,r.jsxs)(d.Z,{hover:!0,tabIndex:-1,onClick:()=>eW(e),children:[(0,r.jsx)(c.Z,{component:"th",scope:"row",padding:"none",children:(0,r.jsxs)(G.Z,{ml:1,direction:"row",alignItems:"center",spacing:2,children:[(0,r.jsx)(E.Z,{sx:{ml:2,width:60,height:60},children:(0,r.jsx)(a.Z,{width:30})}),(0,r.jsx)(Z.Z,{variant:"subtitle2",noWrap:!0,children:e.getDisplayableTitle()})]})}),(0,r.jsx)(c.Z,{align:"left",children:e.getDisplayValue()}),(0,r.jsx)(c.Z,{align:"right",children:(0,r.jsx)(b.Z,{size:"large",color:"inherit",onClick:t=>{eE(t,e)},children:(0,r.jsx)($.Z,{})})})]},t)}),eA>0&&(0,r.jsx)(d.Z,{style:{height:53*eA},children:(0,r.jsx)(c.Z,{colSpan:6})})]}),eR&&(0,r.jsx)(X.Z,{children:(0,r.jsx)(d.Z,{children:(0,r.jsx)(c.Z,{align:"center",colSpan:6,sx:{py:3},children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(Z.Z,{variant:"h6",paragraph:!0,children:"Not found"}),(0,r.jsxs)(Z.Z,{variant:"body2",children:["No results found for \xa0",(0,r.jsxs)("strong",{children:['"',eZ,'"']}),".",(0,r.jsx)("br",{})," Try checking for typos or using complete words."]})]})})})})]})}),(0,r.jsx)(ee.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:o?o.length:0,rowsPerPage:ef,page:_,onPageChange:(e,t)=>{M(t)},onRowsPerPageChange:e=>{M(0),eb(parseInt(e.target.value,10))}})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(Z.Z,{variant:"h4",gutterBottom:!0,children:"Advanced"})}),ek&&(0,r.jsx)(ec(),{target:"_blank",href:ek,children:"View identity's DID on blockchain explorer"})]}),(0,r.jsxs)(et.ZP,{open:!!T,anchorEl:T,onClose:eN,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{p:1,width:140,"& .MuiMenuItem-root":{px:1,typography:"body2",borderRadius:.75}}},children:[(0,r.jsx)(ei.Z,{onClick:()=>{eN(),S(!0);let e=(0,el.m7)(j.verifiableCredential.getType());P(e),N(j.verifiableCredential.getSubject().getProperty(e.key)),A(B.b1.EDIT)},children:"Edit"}),(0,r.jsx)(ei.Z,{sx:{color:"error.main"},onClick:()=>{eN(),ew(!0)},children:"Delete"})]}),(0,r.jsx)(s.Z,{title:"Delete this Credential?",content:"Do you want to delete this Credential?",open:eC,onClose:eT}),(0,r.jsx)(O,{open:f,onClose:e=>{C(!1),console.log("selected item",e),e&&(S(!0),P(e),N(""),A(B.b1.NEW),m(null))},availableItemsForAddition:y}),(0,r.jsx)(B.ZP,{credentialInfo:k,defaultValue:I,type:V,open:w,originCredential:j,onClose:eI})]})}}},function(e){e.O(0,[6990,6110,8920,7679,6953,6685,6540,9166,6432,7125,2971,596,1744],function(){return e(e.s=11616)}),_N_E=e.O()}]);