(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8541],{43226:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var i=n(20791),r=n(13428),o=n(2265),a=n(57042),l=n(43381),s=n(95600),c=n(35843),u=n(87927),d=n(28702),g=n(26520),p=n(25702);function getTypographyUtilityClass(e){return(0,p.Z)("MuiTypography",e)}(0,g.Z)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var m=n(57437);let h=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],useUtilityClasses=e=>{let{align:t,gutterBottom:n,noWrap:i,paragraph:r,variant:o,classes:a}=e,l={root:["root",o,"inherit"!==e.align&&`align${(0,d.Z)(t)}`,n&&"gutterBottom",i&&"noWrap",r&&"paragraph"]};return(0,s.Z)(l,getTypographyUtilityClass,a)},f=(0,c.ZP)("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t[`align${(0,d.Z)(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})(({theme:e,ownerState:t})=>(0,r.Z)({margin:0},"inherit"===t.variant&&{font:"inherit"},"inherit"!==t.variant&&e.typography[t.variant],"inherit"!==t.align&&{textAlign:t.align},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.paragraph&&{marginBottom:16})),y={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},v={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},transformDeprecatedColors=e=>v[e]||e,x=o.forwardRef(function(e,t){let n=(0,u.Z)({props:e,name:"MuiTypography"}),o=transformDeprecatedColors(n.color),s=(0,l.Z)((0,r.Z)({},n,{color:o})),{align:c="inherit",className:d,component:g,gutterBottom:p=!1,noWrap:v=!1,paragraph:x=!1,variant:S="body1",variantMapping:C=y}=s,w=(0,i.Z)(s,h),b=(0,r.Z)({},s,{align:c,color:o,className:d,component:g,gutterBottom:p,noWrap:v,paragraph:x,variant:S,variantMapping:C}),I=g||(x?"p":C[S]||y[S])||"span",Z=useUtilityClasses(b);return(0,m.jsx)(f,(0,r.Z)({as:I,ref:t,ownerState:b,className:(0,a.Z)(Z.root,d)},w))});var S=x},59782:function(e,t,n){"use strict";n.d(t,{Z:function(){return createSvgIcon}});var i=n(13428),r=n(2265),o=n(20791),a=n(57042),l=n(95600),s=n(28702),c=n(87927),u=n(35843),d=n(26520),g=n(25702);function getSvgIconUtilityClass(e){return(0,g.Z)("MuiSvgIcon",e)}(0,d.Z)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var p=n(57437);let m=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],useUtilityClasses=e=>{let{color:t,fontSize:n,classes:i}=e,r={root:["root","inherit"!==t&&`color${(0,s.Z)(t)}`,`fontSize${(0,s.Z)(n)}`]};return(0,l.Z)(r,getSvgIconUtilityClass,i)},h=(0,u.ZP)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,"inherit"!==n.color&&t[`color${(0,s.Z)(n.color)}`],t[`fontSize${(0,s.Z)(n.fontSize)}`]]}})(({theme:e,ownerState:t})=>{var n,i,r,o,a,l,s,c,u,d,g,p,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:t.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(n=e.transitions)||null==(i=n.create)?void 0:i.call(n,"fill",{duration:null==(r=e.transitions)||null==(r=r.duration)?void 0:r.shorter}),fontSize:({inherit:"inherit",small:(null==(o=e.typography)||null==(a=o.pxToRem)?void 0:a.call(o,20))||"1.25rem",medium:(null==(l=e.typography)||null==(s=l.pxToRem)?void 0:s.call(l,24))||"1.5rem",large:(null==(c=e.typography)||null==(u=c.pxToRem)?void 0:u.call(c,35))||"2.1875rem"})[t.fontSize],color:null!=(d=null==(g=(e.vars||e).palette)||null==(g=g[t.color])?void 0:g.main)?d:({action:null==(p=(e.vars||e).palette)||null==(p=p.action)?void 0:p.active,disabled:null==(m=(e.vars||e).palette)||null==(m=m.action)?void 0:m.disabled,inherit:void 0})[t.color]}}),f=r.forwardRef(function(e,t){let n=(0,c.Z)({props:e,name:"MuiSvgIcon"}),{children:l,className:s,color:u="inherit",component:d="svg",fontSize:g="medium",htmlColor:f,inheritViewBox:y=!1,titleAccess:v,viewBox:x="0 0 24 24"}=n,S=(0,o.Z)(n,m),C=r.isValidElement(l)&&"svg"===l.type,w=(0,i.Z)({},n,{color:u,component:d,fontSize:g,instanceFontSize:e.fontSize,inheritViewBox:y,viewBox:x,hasSvgAsChild:C}),b={};y||(b.viewBox=x);let I=useUtilityClasses(w);return(0,p.jsxs)(h,(0,i.Z)({as:d,className:(0,a.Z)(I.root,s),focusable:"false",color:f,"aria-hidden":!v||void 0,role:v?"img":void 0,ref:t},b,S,C&&l.props,{ownerState:w,children:[C?l.props.children:l,v?(0,p.jsx)("title",{children:v}):null]}))});function createSvgIcon(e,t){function Component(n,r){return(0,p.jsx)(f,(0,i.Z)({"data-testid":`${t}Icon`,ref:r},n,{children:e}))}return Component.muiName=f.muiName,r.memo(r.forwardRef(Component))}f.muiName="SvgIcon"},43381:function(e,t,n){"use strict";n.d(t,{Z:function(){return extendSxProp}});var i=n(13428),r=n(20791),o=n(15959),a=n(58122);let l=["sx"],splitProps=e=>{var t,n;let i={systemProps:{},otherProps:{}},r=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:a.Z;return Object.keys(e).forEach(t=>{r[t]?i.systemProps[t]=e[t]:i.otherProps[t]=e[t]}),i};function extendSxProp(e){let t;let{sx:n}=e,a=(0,r.Z)(e,l),{systemProps:s,otherProps:c}=splitProps(a);return t=Array.isArray(n)?[s,...n]:"function"==typeof n?(...e)=>{let t=n(...e);return(0,o.P)(t)?(0,i.Z)({},s,t):s}:(0,i.Z)({},s,n),(0,i.Z)({},c,{sx:t})}},62784:function(e,t,n){Promise.resolve().then(n.bind(n,24988))},24988:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return page}});var i=n(57437),r=n(96283),o=n(9254),a=n(57042);let VerticalStackLoadingCard_VerticalStackLoadingCard=e=>{let{className:t}=e;return(0,i.jsx)("div",{className:(0,a.Z)("vertical-stack-loading-card",t),children:(0,i.jsxs)("div",{className:"content",children:[(0,i.jsx)("p",{}),(0,i.jsx)("h2",{}),(0,i.jsx)("h2",{})]})})};var l=n(40542),s=n(97716),c=n(90726),u=n(95815),d=n(94025),g=n(43226),p=n(19739),m=n(63491),h=n(60230),f=n(23965),y=n(51894);let v="\n  id\n  identityInfo { ".concat("\n  did\n  createdAt\n  credentialsCount\n  creatingAppDid\n"," }\n  claimUrl\n  expiresAt\n  claimCompletedAt\n");let ClaimableIdentity=class ClaimableIdentity{static async fromJson(e){let t=new ClaimableIdentity;return Object.assign(t,e),t.createdAt=new Date(e.createdAt),t}};let IdentityClaimRequest=class IdentityClaimRequest{static async fromJson(e){let t=new IdentityClaimRequest;return Object.assign(t,e),t.identityInfo=await ClaimableIdentity.fromJson(e.identityInfo),e.expiresAt&&(t.expiresAt=new Date(e.expiresAt)),e.claimCompletedAt&&(t.claimCompletedAt=new Date(e.claimCompletedAt)),t}};var x=n(29748),S=n(91395);function _templateObject(){let e=(0,h._)(["\n            query IdentityClaimRequest($claimRequestId: String!, $nonce: String!) {\n              identityClaimRequest(id: $claimRequestId, nonce: $nonce) {\n                ","\n              }\n            }\n          "]);return _templateObject=function(){return e},e}async function fetchIdentityClaimRequest(e,t){return(0,y.H)(async()=>{var n,i;let r=await (0,x.Pt)(async()=>(await (0,S.W)()).query({query:(0,f.Ps)(_templateObject(),v),variables:{claimRequestId:e,nonce:t}}),null,[d._s.RequestExpired,d._s.AlreadyClaimed,d._s.InvalidNonce,d._s.RequestNotExists]);return(null==r?void 0:null===(n=r.data)||void 0===n?void 0:n.identityClaimRequest)?IdentityClaimRequest.fromJson(null==r?void 0:null===(i=r.data)||void 0===i?void 0:i.identityClaimRequest):null})}var C=n(78596),w=n(36079),b=n(14776),I=n(24033),Z=n(2265);let j="claim-identity";var page=()=>{let{mounted:e}=(0,s.s)(),t=(0,I.useSearchParams)(),n=t.get("request"),a=t.get("nonce"),[h,f]=(0,Z.useState)(!0),[y,v]=(0,Z.useState)(!1),[x,S]=(0,Z.useState)(null),[k,R]=(0,Z.useState)(null),[A,q]=(0,Z.useState)(null),[B,P]=(0,Z.useState)(null),[O]=(0,l.V)(null==B?void 0:B.name$),[N,_]=(0,Z.useState)(null),D=(0,I.useRouter)(),[E]=(0,l.V)(b.DR),[F]=(0,l.V)(b.jU),T=!h&&E,{showSuccessToast:M,showErrorToast:U}=(0,p.p)();(0,Z.useEffect)(()=>{n&&!x&&(w.k.log(j,"Fetching claim request details"),fetchIdentityClaimRequest(n,a).then(e=>{if(w.k.log(j,"Got claim request",e),e){var t;S(e),R(null===(t=e.identityInfo)||void 0===t?void 0:t.creatingAppDid)}else f(!1)}).catch(e=>{if(f(!1),e instanceof u._)switch(e.appExceptionCode){case d._s.AlreadyClaimed:_("This identity is already claimed");break;case d._s.InvalidNonce:_("Security code is invalie");break;case d._s.RequestExpired:_("Request expired, please try again from your original application");break;case d._s.RequestNotExists:_("This identity transfer request doesn't exist")}}))},[n,a,x]),(0,Z.useEffect)(()=>{k&&!A&&(w.k.log(j,"Fetching creating app's DID document on chain"),C._.resolveDIDDocument(k).then(async e=>{if(f(!1),q(e),w.k.log(j,"Got creating app's DID document:",e),e){let t=e.getCredentialByType("ApplicationCredential");t?P(await (0,c.C)(t)):w.k.error(j,"The on chain DID document supposed to contain an app info credential doesn't have such credential")}else w.k.warn(j,"Unable to resolve DID Document of the app that created the managed identity")}))},[k,A]);let claimIdentity=async()=>{v(!0);let e=await F.get("identity").claimManagedIdentity(x,a);e?(M("Identity claimed successfully"),D.replace("/dashboard")):(U("Sorry, the identity failed to be claimed for some reason"),v(!1))};return e?(0,i.jsxs)("div",{className:"flex flex-col col-span-full",children:[(0,i.jsx)(g.Z,{variant:"h5",children:"Identity claim"}),!T&&(0,i.jsx)(VerticalStackLoadingCard_VerticalStackLoadingCard,{}),T&&!h&&(0,i.jsx)(i.Fragment,{children:!x&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g.Z,{children:"Sorry, we could not find information about this identity at the moment."}),N&&(0,i.jsx)(g.Z,{children:N})]})}),x&&(0,i.jsxs)(i.Fragment,{children:[O&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(g.Z,{children:["A new Web3 identity has been prepared for you by ",(0,i.jsx)("b",{children:O})," and is ready for you to claim."]}),(0,i.jsxs)(g.Z,{children:["Claiming means that this identity, initially created and controlled by ",O,", will now fully become yours, together with your other identities in your account."]})]}),!O&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g.Z,{children:"A new Web3 identity has been prepared for you by a third party application."}),(0,i.jsx)(g.Z,{children:"Claiming means that this identity, initially created and controlled by another application, will now fully become yours, together with your other identities in your account."})]}),B&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(r.J,{credential:B})}),!F&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"flex items-center space-x-3 mt-8",children:e&&!F&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.c,{onClick:()=>{(0,m.qC)(window.location.toString()),D.push("/register")},children:"Sign up"}),(0,i.jsx)(o.c,{onClick:()=>{(0,m.qC)(window.location.toString()),D.push("/signin")},children:"Sign in"})]})})}),F&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.c,{className:"mt-8",onClick:claimIdentity,busy:y,children:"Claim this identity"}),(0,i.jsx)(g.Z,{children:"This new identity will be transfered to your account."})]})]})]}):null}},96283:function(e,t,n){"use strict";n.d(t,{J:function(){return CredentialAvatar}});var i=n(57437),r=n(40542),o=n(3283),a=n(57042),l=n(16691),s=n.n(l);let CredentialAvatar=e=>{let{credential:t,width:n=60,height:l=60,className:c}=e,[u]=(0,r.V)(null==t?void 0:t.representativeIcon$);return(0,i.jsx)(o.Z,{sx:{width:n,height:l,padding:"string"==typeof u?0:"".concat(.125*Math.floor(n/8),"rem"),backgroundColor:"#7575754d"},className:(0,a.Z)(c),children:"string"==typeof u?(0,i.jsx)(s(),{src:u,alt:"",width:n,height:l}):u})}},9254:function(e,t,n){"use strict";n.d(t,{c:function(){return MainButton}});var i=n(57437),r=n(6882),o=n(49050),a=n(57042);let MainButton=e=>{let{leftIcon:t,size:n="medium",mode:l="default",onClick:s,children:c,busy:u=!1,disabled:d=!1,className:g}=e,p=(0,i.jsx)(r.Z,{size:16});return(0,i.jsx)("div",{className:(0,a.Z)("flex",g),children:(0,i.jsx)(o.Z,{className:"flex-1",startIcon:u?p:t,disabled:u||d,size:n,color:"default"===l?"primary":"error",variant:"contained",onClick:s,children:c})})}},40542:function(e,t,n){"use strict";n.d(t,{V:function(){return useBehaviorSubject}});var i=n(2265);let useBehaviorSubject=e=>{let[t,n]=(0,i.useState)(null==e?void 0:e.getValue()),[r,o]=(0,i.useState)();return(0,i.useEffect)(()=>{if(!e){n(null);return}let t=e.subscribe({next:e=>{n(e)},error:o});return()=>t.unsubscribe()},[e]),[t]}},97716:function(e,t,n){"use strict";n.d(t,{s:function(){return useMounted}});var i=n(2265);let useMounted=()=>{let[e,t]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{t(!0)},[]),{mounted:e}}},19739:function(e,t,n){"use strict";n.d(t,{p:function(){return useToast}});var i=n(36953);function useToast(){let{enqueueSnackbar:e}=(0,i.Ds)();return{showSuccessToast:t=>{e(t,{variant:"success"})},showErrorToast:t=>{e(t,{variant:"error"})}}}},63491:function(e,t,n){"use strict";n.d(t,{$Y:function(){return setOnGoingFlowOperation},Ad:function(){return clearPostSignInUrl},Kt:function(){return getOnGoingFlowOperation},cX:function(){return r},fK:function(){return clearOnGoingFlowOperation},qC:function(){return setPostSignInUrl},vX:function(){return usePostSignInFlow}});var i,r,o=n(92e3),a=n(36079);(i=r||(r={}))[i.OnBoardingEmailBinding=0]="OnBoardingEmailBinding",i[i.OnBoardingBrowserBinding=1]="OnBoardingBrowserBinding",i[i.EmailSignIn=2]="EmailSignIn";let l="ongoingflowoperation",s="postsigninurl";function getOnGoingFlowOperation(){return r[localStorage.getItem(l)]}function setOnGoingFlowOperation(e){localStorage.setItem(l,r[e])}function clearOnGoingFlowOperation(){localStorage.removeItem(l)}function setPostSignInUrl(e){a.k.log("flow","Setting post sign in url to:",e),localStorage.setItem(s,e)}function clearPostSignInUrl(){a.k.log("flow","Clearing post sign in url"),localStorage.removeItem(s)}function usePostSignInFlow(){let e=(0,o.useRouter)();return{navigateToPostSignInLandingPage(t){let n=localStorage.getItem(s);if(n)a.k.log("flow","Navigating to post sign in landing page:",n),e.replace(n),clearPostSignInUrl();else{let n=t||"/dashboard";a.k.log("flow","Navigating to post sign in landing page ".concat(n)),e.push(n)}}}}}},function(e){e.O(0,[6990,9787,9443,8218,3988,395,8321,3824,6642,1228,5295,1510,1396,6953,2e3,7998,3262,2971,7864,1744],function(){return e(e.s=62784)}),_N_E=e.O()}]);