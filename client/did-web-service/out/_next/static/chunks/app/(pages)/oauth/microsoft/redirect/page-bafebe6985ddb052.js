(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1716],{54611:function(t,n,e){Promise.resolve().then(e.bind(e,64098))},64098:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return page}});var a=e(57437),i=e(2265),u=e(24033),r=e(4778),o=e(73052),c=e(63491),s=e(60230),l=e(36079),h=e(29748),f=e(91395),d=e(23965),m=e(11059);function _templateObject(){let t=(0,s._)(["\n        mutation OauthMSSignIn($input: MsSignInInput!) {\n          oauthMSSignIn(input: $input) { accessToken refreshToken }\n        }\n      "]);return _templateObject=function(){return t},t}function _templateObject1(){let t=(0,s._)(["\n        mutation OauthMSBindEmail($input: MsBindEmailInput!) {\n          oauthMSBindEmail(input: $input)\n        }\n      "]);return _templateObject1=function(){return t},t}async function oauthMSSignIn(t){l.k.log("user","oauth MS sign in.");let n={code:t},e=await (0,h.Pt)(async()=>(await (0,f.W)()).mutate({mutation:(0,d.Ps)(_templateObject()),variables:{input:n}}));if(null==e||!e.data||!e.data.oauthMSSignIn)return l.k.error("user","failed to oauth MS sign in."),null;{let{accessToken:t,refreshToken:n}=e.data.oauthMSSignIn;return(0,m.vz)(t,n)}}async function oauthMSBindEmail(t){l.k.log("user","oauth MS bind email.");let n={code:t},e=await (0,h.Pt)(async()=>(await (0,f.W)()).mutate({mutation:(0,d.Ps)(_templateObject1()),variables:{input:n}}));return(null==e?void 0:e.data)&&e.data.oauthMSBindEmail?(l.k.log("user","Oauth MS email bound successfully"),!0):(l.k.error("user","failed to oauth MS bind email."),!1)}var p=e(31514),page=()=>{let t=(0,u.useRouter)(),n=(0,u.useSearchParams)(),e=n.get("code"),{navigateToPostSignInLandingPage:s}=(0,c.vX)();return(0,i.useEffect)(()=>{if(e){let n=(0,c.Kt)();switch(n){case c.cX.OnBoardingEmailBinding:oauthMSBindEmail(e).then(n=>{n?t.push("/account/security"):((0,c.fK)(),t.push("/account/security?error=unknown"))}).catch(n=>{n&&n instanceof r.E?((0,c.fK)(),t.push("/account/security?error=emailExists")):((0,c.fK)(),t.push("/account/security?error=unknown"))});break;case c.cX.EmailSignIn:oauthMSSignIn(e).then(n=>{n?((0,c.fK)(),s()):((0,c.fK)(),t.push("/signin?error=unknown"))}).catch(n=>{n instanceof o.h&&((0,c.fK)(),t.push("/signin?error=oauthEmailNotExists"))});break;default:alert("Invalid operation, please try again.")}}else alert("MicrosoftRedirect: No code from Microsoft authentication callback.")},[]),(0,a.jsx)("div",{children:(0,a.jsx)(p.Z,{})})}}},function(t){t.O(0,[6990,9787,9443,8218,3988,3861,6506,8644,9830,1711,1396,2e3,7056,8815,2971,7864,1744],function(){return t(t.s=54611)}),_N_E=t.O()}]);