(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2919],{59625:function(e,t,n){Promise.resolve().then(n.bind(n,76414))},76414:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return page}});var o=n(57437),a=n(2265),i=n(24033),u=n(92e3),l=n(4778),r=n(73052),c=n(63491),s=n(60230),g=n(36079),h=n(29748),f=n(91395),d=n(23965),m=n(11059);function _templateObject(){let e=(0,s._)(["\n        mutation OauthGoogleSignIn($input: GoogleSignInInput!) {\n          oauthGoogleSignIn(input: $input) { accessToken refreshToken }\n        }\n      "]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,s._)(["\n        mutation OauthGoogleBindEmail($input: GoogleBindEmailInput!) {\n          oauthGoogleBindEmail(input: $input)\n        }\n      "]);return _templateObject1=function(){return e},e}async function oauthGoogleSignIn(e){g.k.log("user","oauth Google sign in.");let t={code:e},n=await (0,h.Pt)(async()=>(await (0,f.W)()).mutate({mutation:(0,d.Ps)(_templateObject()),variables:{input:t}}));if(null==n||!n.data||!n.data.oauthGoogleSignIn)return g.k.error("user","failed to oauth Google sign in."),null;{let{accessToken:e,refreshToken:t}=n.data.oauthGoogleSignIn;return(0,m.vz)(e,t)}}async function oauthGoogleBindEmail(e){g.k.log("user","oauth Google bind email.");let t={code:e},n=await (0,h.Pt)(async()=>(await (0,f.W)()).mutate({mutation:(0,d.Ps)(_templateObject1()),variables:{input:t}}));return(null==n?void 0:n.data)&&n.data.oauthGoogleBindEmail?(g.k.log("user","Oauth Google email bound successfully"),!0):(g.k.error("user","failed to oauth Google bind email."),!1)}var p=n(31514),page=()=>{let e=(0,u.useRouter)(),t=(0,i.useSearchParams)(),n=t.get("code"),{navigateToPostSignInLandingPage:s}=(0,c.vX)();return(0,a.useEffect)(()=>{if(n){let t=(0,c.Kt)();switch(t){case c.cX.OnBoardingEmailBinding:oauthGoogleBindEmail(n).then(t=>{t?e.push("/account/security"):((0,c.fK)(),e.push("/account/security?error=unknown"))}).catch(t=>{t&&t instanceof l.E?((0,c.fK)(),e.push("/account/security?error=emailExists")):((0,c.fK)(),e.push("/account/security?error=unknown"))});break;case c.cX.EmailSignIn:oauthGoogleSignIn(n).then(t=>{t?((0,c.fK)(),s()):((0,c.fK)(),e.push("/signin?error=unknownGoogle"))}).catch(t=>{t instanceof r.h&&((0,c.fK)(),e.push("/signin?error=oauthGoogleEmailNotExists"))});break;default:alert("Invalid operation, please try again.")}}else alert("GoogleRedirect: No code from Google authentication callback.")},[]),(0,o.jsx)("div",{children:(0,o.jsx)(p.Z,{})})}}},function(e){e.O(0,[6990,9787,9443,8218,3988,3861,6506,8644,9830,1711,1396,2e3,7056,8815,2971,7864,1744],function(){return e(e.s=59625)}),_N_E=e.O()}]);